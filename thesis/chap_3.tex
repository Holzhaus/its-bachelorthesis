\chapter{Umsetzung}
\label{chap:impl}

\section{Bewertungskriterien}

\subsection{Kriterien für verlustlose Konversion}

\subsubsection{CDATA-Abschnitt}

Mithilfe von CDATA-Abschnitten lässt sich Text, der Markup-Zeichen wie beispielsweise das Kleiner-als-Zeichen\footnote{Unicode-Codepoint \texttt{U+003C}: \texttt{LESS-THAN SIGN}} enthält, direkt in ein XML-Dokument einbetten, ohne dass diese Zeichen als Markup interpretiert werden.

Dies ist vor allem dann sinnvoll, wenn es unpraktikabel ist, alle Markup-Zeichen im Text einzeln durch die jeweilige Zeichen- oder Entity-Referenz zu ersetzen. CDATA stellt somit eine weitere Weg dar, Zeichendaten in einem XML-Dokument anzugeben.\cite[Abschnitt~2.4]{maler2008xml}

Der Unterschied zwischen Zeichendaten aus CDATA-Abschnitten und solchen, bei denen dies nicht der Fall ist, ist jedoch lediglich ein syntaktischer. Daher werden bei der \acrlong{c14n} alle CDATA-Abschnitte im Eingabedokument durch den entsprechenden \emph{Character Content} ersetzt\cite[Abschnitt~2.1]{boyer2001c14n}.

Für die Verlustlosigkeit der Konversion ist es daher unerheblich, ob die CDATA-Abschnitte im Ursprungsdokument als solche erhalten bleiben, oder lediglich die Zeichendaten beibehalten werden.

\subsubsection{Kommentare}

\acrshort{xml} verfügt über die Möglichkeit, Dokumente mit Kommentaren zu versehen. Allerdings müssen diese nicht durch den XML-Prozessor zugänglich gemacht werden. In der Empfehlung des \gls{w3c} heißt es dazu:

\begin{foreigndisplayquote}{english}[{\cite[Abschnitt~2.5]{maler2008xml}}]
They are not part of the document's character data; an XML processor may, but need not, make it possible for an application to retrieve the text of comments.
\end{foreigndisplayquote}

Zudem ist auch bei der Implementierung von \acrlong{c14n} die Unterstützung von \emph{Kanonischem XML mit Kommentaren} lediglich empfohlen, während die Möglichkeit der Umwandlung in \emph{Kanonisches XML} ausschließlich aller Kommentare zwingend erforderlich ist.\cite[Abschnitt~2.1]{boyer2001c14n}

Folglich ist es nicht nötig, dass sich die Kommentare im XML-Eingabedokument nach dem $XML\rightarrow{}JSON\rightarrow{}XML$ Roundtrip auch in der Ausgabe wiederfinden.

\subsubsection{Dokumentordnung}

\paragraph{Elementordnung}

Die Spezifikation der \acrshort{c14n} bezieht sich bezüglich der Ordnung auf die \acrshort{w3c}-Empfehlung zur \acrfull{xpath}\cite[Abschnitt~2.2]{boyer2001c14n}.

\begin{foreigndisplayquote}{english}[{\cite[Abschnitt~5]{clark1999xpath1}}]
There is an ordering, document order, defined on all the nodes in the document corresponding to the order in which the first character of the XML representation of each node occurs in the XML representation of the document after expansion of general entities. Thus, the root node will be the first node. Element nodes occur before their children. Thus, document order orders element nodes in order of the occurrence of their start-tag in the XML (after expansion of entities).
\end{foreigndisplayquote}

Folglich muss die Reihenfolge der Element-Nodes bei der Konversion beibehalten werden.

\paragraph{Ordnung von Attributen und Namespaces}

Laut dem \acrshort{xml}-Standard unwichtig kommen der Reihenfolge, in die Attribute eines Elements angegeben wurden, keine Bedeutung zu.

\begin{foreigndisplayquote}{english}[{\cite[Abschnitt~3.1]{maler2008xml}}]
Note that the order of attribute specifications in a start-tag or empty-element tag is not significant.
\end{foreigndisplayquote}

Dies wird auch von der \acrshort{xpath}-Spezifikation untermauert:

\begin{foreigndisplayquote}{english}[{\cite[Abschnitt~5]{clark1999xpath1}}]
The relative order of namespace nodes is implementation-dependent. The relative order of attribute nodes is implementation-dependent.
\end{foreigndisplayquote}

Die Reihenfolge der Attribute eines Elements nach einem $\text{\acrshort{xml}}\rightarrow{}\text{\acrshort{json}}\rightarrow{}\text{\acrshort{xml}}$-Roundtrip ist daher beliebig und muss nicht mit der Reihenfolge vor der Umwandlung identisch sein.

\subsubsection{Whitespace}

Whitespace innerhalb des Wurzelelements des Dokumentens muss beibehalten werden, während 

\begin{foreigndisplayquote}{english}[{\cite[Abschnitt~2.1]{boyer2001c14n}}]
    All whitespace within the root document element MUST be preserved (except for any \texttt{\#xD} characters deleted by line delimiter normalization). This includes all whitespace in external entities. Whitespace outside of the root document element MUST be discarded.
\end{foreigndisplayquote}


\section{XML-JSON-Konversionsverfahren}

\subsection{Json-lib}
\convtool[
    author={Andres Almiray (basierend auf Douglas Crockford)},
    url={http://json-lib.sourceforge.net/},
    license={Apache Software License 2.0},
    language=Java,
    version={2.4 (2010-12-14)},
]{jsonlib}

\subsection{JsonML}
\convtool[
    author={Stephen M. McKamey},
    url={http://www.jsonml.org/},
    license=MIT,
    language=JavaScript,
    version=2.0.0 (2016-04-09),
]{jsonml}

\subsection{JXON}
\convtool[
    author={MDN / Martin Raifer},
    url={https://github.com/tyrasd/jxon},
    license=GNU General Public License 3.0,
    language=JavaScript,
    version=2.0.0-beta.4 (2016-11-22),
]{jxon}

\subsection{org.json.XML}
\convtool[
    author={JSON.org / Sean Leary},
    url={https://github.com/stleary/JSON-java},
    license=MIT,
    language=Java,
    version=20160810 (2016-08-10),
]{orgjsonxml}

\subsection{Pesterfish}
\convtool[
    author={Jacob Smullyan},
    url={https://bitbucket.org/smulloni/pesterfish/},
    license=MIT,
    language=Python,
    version=1578db9 (2010-11-22),
]{pesterfish}

\subsection{x2js}
\convtool[
    author={Axinom},
    url={https://github.com/x2js/x2js},
    license=Apache Software License 2.0,
    language=JavaScript,
    version=3.1.0 (2016-12-05),
]{x2js}

\subsection{xmljson}
\convtool[
    author={S Anand},
    url={https://github.com/sanand0/xmljson},
    license=MIT,
    language=Python,
    version=0.1.7 (2016-09-13),
]{xmljson}
